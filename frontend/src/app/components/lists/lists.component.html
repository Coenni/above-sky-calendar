<div class="lists-page">
  <div class="container">
    <div class="header">
      <div class="header-content">
        <h1>ğŸ“‹ Lists</h1>
        <p class="subtitle">Manage your family lists</p>
      </div>
      <div class="header-actions">
        <button (click)="toggleListForm()" class="btn btn-primary">
          {{ showListForm() ? 'âœ• Cancel' : '+ Create List' }}
        </button>
      </div>
    </div>

    <!-- List Form -->
    @if (showListForm()) {
      <div class="list-form-card">
        <h3>Create New List</h3>
        <form (ngSubmit)="createList()">
          <div class="form-row">
            <div class="form-group">
              <label for="name">List Name</label>
              <input
                type="text"
                id="name"
                [(ngModel)]="newList.name"
                name="name"
                required
                class="form-control"
                placeholder="e.g., Grocery Shopping"
              />
            </div>

            <div class="form-group">
              <label for="type">List Type</label>
              <select id="type" [(ngModel)]="newList.type" name="type" class="form-control">
                <option value="shopping">Shopping</option>
                <option value="todo">To-Do</option>
                <option value="packing">Packing</option>
                <option value="custom">Custom</option>
              </select>
            </div>
          </div>

          <div class="form-group">
            <label>
              <input type="checkbox" [(ngModel)]="newList.isShared" name="isShared" />
              Share with family
            </label>
          </div>

          <button type="submit" class="btn btn-primary">Create List</button>
        </form>
      </div>
    }

    @if (loading()) {
      <div class="loading">Loading lists...</div>
    }

    @if (!loading()) {
      <div class="lists-container" [ngClass]="{'with-detail': activeList()}">
        <!-- Lists Grid -->
        <div class="lists-grid" [ngClass]="{'with-detail': activeList()}">
          @if (lists().length === 0) {
            <div class="no-lists">
              <p>No lists yet. Create your first list!</p>
            </div>
          }

          @for (list of lists(); track list.id) {
            <div class="list-card" [ngClass]="{'selected': activeList()?.id === list.id}">
              <div class="list-header" (click)="selectList(list)">
                <div class="list-icon">
                  {{ list.type === 'shopping' ? 'ğŸ›’' : list.type === 'todo' ? 'âœ“' : list.type === 'packing' ? 'ğŸ’' : 'ğŸ“‹' }}
                </div>
                <div class="list-info">
                  <h3 class="list-name">{{ list.name }}</h3>
                  <div class="list-meta">
                    <span class="list-type">{{ list.type }}</span>
                    @if (list.isShared) {
                      <span class="list-shared">ğŸ‘¥ Shared</span>
                    }
                  </div>
                </div>
              </div>
              <div class="list-actions">
                <button (click)="deleteList(list.id); $event.stopPropagation()" class="btn-icon" title="Delete">
                  ğŸ—‘ï¸
                </button>
              </div>
            </div>
          }
        </div>

        <!-- List Detail Panel -->
        @if (activeList(); as selectedList) {
          <div class="list-detail">
            <div class="detail-header">
              <div class="detail-title">
                <h2>{{ selectedList.name }}</h2>
                <button (click)="closeListDetail()" class="btn-close">Ã—</button>
              </div>
              <div class="detail-meta">
                <span class="detail-type">{{ selectedList.type }}</span>
                @if (selectedList.isShared) {
                  <span class="detail-shared">ğŸ‘¥ Shared</span>
                }
              </div>
            </div>

            <div class="add-item-form">
              <input
                type="text"
                [ngModel]="newItemName()"
                (ngModelChange)="newItemName.set($event)"
                (keyup.enter)="addItem()"
                class="form-control"
                placeholder="Add new item..."
              />
              <button (click)="addItem()" class="btn btn-primary">Add</button>
            </div>

            <div class="items-list">
              @if (activeListItems().length === 0) {
                <div class="no-items">
                  <p>No items yet. Add your first item!</p>
                </div>
              }

              @for (item of activeListItems(); track item.id) {
                <div class="list-item" [ngClass]="{'completed': item.isChecked}">
                  <label class="item-checkbox">
                    <input 
                      type="checkbox" 
                      [checked]="item.isChecked"
                      (change)="toggleItem(item)"
                    />
                    <span class="checkmark"></span>
                  </label>
                  <span class="item-name">{{ item.content }}</span>
                  <button (click)="deleteItem(item.id)" class="btn-icon" title="Delete">
                    ğŸ—‘ï¸
                  </button>
                </div>
              }
            </div>
          </div>
        }
      </div>
    }
  </div>
</div>
