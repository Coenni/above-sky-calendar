openapi: 3.0.3
info:
  title: Above Sky Calendar API
  description: |
    Comprehensive API for the Above Sky Calendar family organization application.
    This API provides endpoints for managing events, tasks, rewards, meals, photos, lists, and family members.
  version: 1.0.0
  contact:
    name: Above Sky Calendar Team
    email: support@aboveskycalendar.com

servers:
  - url: http://localhost:8080
    description: Local development server
  - url: https://api.aboveskycalendar.com
    description: Production server

tags:
  - name: Events
    description: Calendar event management
  - name: Tasks
    description: Task and chore management with rewards
  - name: Rewards
    description: Rewards system and redemption
  - name: Meals
    description: Meal planning and recipes
  - name: Photos
    description: Photo sharing and comments
  - name: Lists
    description: Shared family lists (shopping, todo, etc.)
  - name: Members
    description: Family member management
  - name: Auth
    description: Authentication and authorization

security:
  - bearerAuth: []

paths:
  # ============================================================================
  # AUTHENTICATION ENDPOINTS
  # ============================================================================
  /api/auth/register:
    post:
      tags:
        - Auth
      summary: Register new user
      description: Create a new user account
      operationId: register
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterRequest'
            example:
              username: john_doe
              email: john@example.com
              password: MySecureP@ssw0rd2024!
              displayName: John Doe
      responses:
        '200':
          description: User registered successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'
        '400':
          description: Invalid input or user already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/auth/login:
    post:
      tags:
        - Auth
      summary: Login user
      description: Authenticate user and return JWT token
      operationId: login
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
            example:
              username: john_doe
              password: MySecureP@ssw0rd2024!
      responses:
        '200':
          description: Login successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'
        '401':
          description: Invalid credentials
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # ============================================================================
  # EVENTS ENDPOINTS
  # ============================================================================
  /api/events:
    get:
      tags:
        - Events
      summary: List all events
      description: Get all events with optional filtering by date range and family member
      operationId: getEvents
      parameters:
        - name: startDate
          in: query
          description: Filter events starting from this date (ISO 8601)
          schema:
            type: string
            format: date-time
          example: "2024-01-01T00:00:00Z"
        - name: endDate
          in: query
          description: Filter events up to this date (ISO 8601)
          schema:
            type: string
            format: date-time
          example: "2024-12-31T23:59:59Z"
        - name: memberId
          in: query
          description: Filter events by assigned family member ID
          schema:
            type: integer
            format: int64
        - name: category
          in: query
          description: Filter events by category
          schema:
            type: string
          example: appointments
        - name: page
          in: query
          description: Page number for pagination
          schema:
            type: integer
            default: 0
        - name: size
          in: query
          description: Number of items per page
          schema:
            type: integer
            default: 20
      responses:
        '200':
          description: List of events
          content:
            application/json:
              schema:
                type: object
                properties:
                  content:
                    type: array
                    items:
                      $ref: '#/components/schemas/Event'
                  pagination:
                    $ref: '#/components/schemas/PaginationMetadata'
        '400':
          description: Invalid request parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    post:
      tags:
        - Events
      summary: Create new event
      description: Create a new calendar event
      operationId: createEvent
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EventInput'
            example:
              title: Doctor Appointment
              description: Annual checkup at the clinic
              startDate: "2024-06-15T10:00:00Z"
              endDate: "2024-06-15T11:00:00Z"
              category: appointments
              color: "#FF5733"
              isAllDay: false
              assignedMembers: [1, 2]
      responses:
        '201':
          description: Event created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Event'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/events/{id}:
    get:
      tags:
        - Events
      summary: Get single event
      description: Get details of a specific event by ID
      operationId: getEventById
      parameters:
        - name: id
          in: path
          required: true
          description: Event ID
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: Event details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Event'
        '404':
          description: Event not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    put:
      tags:
        - Events
      summary: Update existing event
      description: Update an existing calendar event
      operationId: updateEvent
      parameters:
        - name: id
          in: path
          required: true
          description: Event ID
          schema:
            type: integer
            format: int64
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EventInput'
      responses:
        '200':
          description: Event updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Event'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Event not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      tags:
        - Events
      summary: Delete event
      description: Delete a calendar event
      operationId: deleteEvent
      parameters:
        - name: id
          in: path
          required: true
          description: Event ID
          schema:
            type: integer
            format: int64
      responses:
        '204':
          description: Event deleted successfully
        '404':
          description: Event not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/events/recurring:
    get:
      tags:
        - Events
      summary: Get recurring events
      description: Get all recurring event configurations
      operationId: getRecurringEvents
      responses:
        '200':
          description: List of recurring events
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Event'

  # ============================================================================
  # TASKS ENDPOINTS
  # ============================================================================
  /api/tasks:
    get:
      tags:
        - Tasks
      summary: List all tasks
      description: Get all tasks with optional filtering by assignee, status, and priority
      operationId: getTasks
      parameters:
        - name: assigneeId
          in: query
          description: Filter tasks by assigned family member ID
          schema:
            type: integer
            format: int64
        - name: status
          in: query
          description: Filter tasks by status
          schema:
            type: string
            enum: [pending, in_progress, completed]
        - name: priority
          in: query
          description: Filter tasks by priority
          schema:
            type: string
            enum: [low, medium, high]
        - name: category
          in: query
          description: Filter tasks by category
          schema:
            type: string
        - name: page
          in: query
          description: Page number for pagination
          schema:
            type: integer
            default: 0
        - name: size
          in: query
          description: Number of items per page
          schema:
            type: integer
            default: 20
      responses:
        '200':
          description: List of tasks
          content:
            application/json:
              schema:
                type: object
                properties:
                  content:
                    type: array
                    items:
                      $ref: '#/components/schemas/Task'
                  pagination:
                    $ref: '#/components/schemas/PaginationMetadata'
        '400':
          description: Invalid request parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    post:
      tags:
        - Tasks
      summary: Create new task
      description: Create a new task
      operationId: createTask
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TaskInput'
            example:
              title: Clean the garage
              description: Organize and clean the garage area
              dueDate: "2024-06-20T17:00:00Z"
              assignedUserId: 2
              priority: medium
              category: chores
              rewardPoints: 50
      responses:
        '201':
          description: Task created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Task'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/tasks/{id}:
    get:
      tags:
        - Tasks
      summary: Get single task
      description: Get details of a specific task by ID
      operationId: getTaskById
      parameters:
        - name: id
          in: path
          required: true
          description: Task ID
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: Task details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Task'
        '404':
          description: Task not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    put:
      tags:
        - Tasks
      summary: Update existing task
      description: Update an existing task
      operationId: updateTask
      parameters:
        - name: id
          in: path
          required: true
          description: Task ID
          schema:
            type: integer
            format: int64
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TaskInput'
      responses:
        '200':
          description: Task updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Task'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Task not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      tags:
        - Tasks
      summary: Delete task
      description: Delete a task
      operationId: deleteTask
      parameters:
        - name: id
          in: path
          required: true
          description: Task ID
          schema:
            type: integer
            format: int64
      responses:
        '204':
          description: Task deleted successfully
        '404':
          description: Task not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/tasks/{id}/status:
    patch:
      tags:
        - Tasks
      summary: Update task status
      description: Update the status of a task
      operationId: updateTaskStatus
      parameters:
        - name: id
          in: path
          required: true
          description: Task ID
          schema:
            type: integer
            format: int64
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - status
              properties:
                status:
                  type: string
                  enum: [pending, in_progress, completed]
            example:
              status: in_progress
      responses:
        '200':
          description: Task status updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Task'
        '400':
          description: Invalid status
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Task not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/tasks/{id}/complete:
    post:
      tags:
        - Tasks
      summary: Mark task as completed
      description: Mark a task as completed and award points to the assignee
      operationId: completeTask
      parameters:
        - name: id
          in: path
          required: true
          description: Task ID
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: Task completed successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Task'
        '404':
          description: Task not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # ============================================================================
  # REWARDS ENDPOINTS
  # ============================================================================
  /api/rewards:
    get:
      tags:
        - Rewards
      summary: List available rewards
      description: Get all available rewards
      operationId: getRewards
      parameters:
        - name: category
          in: query
          description: Filter rewards by category
          schema:
            type: string
        - name: available
          in: query
          description: Filter by availability
          schema:
            type: boolean
        - name: page
          in: query
          description: Page number for pagination
          schema:
            type: integer
            default: 0
        - name: size
          in: query
          description: Number of items per page
          schema:
            type: integer
            default: 20
      responses:
        '200':
          description: List of rewards
          content:
            application/json:
              schema:
                type: object
                properties:
                  content:
                    type: array
                    items:
                      $ref: '#/components/schemas/Reward'
                  pagination:
                    $ref: '#/components/schemas/PaginationMetadata'

    post:
      tags:
        - Rewards
      summary: Create new reward
      description: Create a new reward
      operationId: createReward
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RewardInput'
            example:
              name: Movie Night
              description: Choose a movie for family movie night
              pointsCost: 100
              category: privileges
              imageUrl: https://example.com/movie.jpg
              stockQuantity: -1
      responses:
        '201':
          description: Reward created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Reward'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/rewards/{id}:
    get:
      tags:
        - Rewards
      summary: Get reward details
      description: Get details of a specific reward by ID
      operationId: getRewardById
      parameters:
        - name: id
          in: path
          required: true
          description: Reward ID
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: Reward details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Reward'
        '404':
          description: Reward not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    put:
      tags:
        - Rewards
      summary: Update reward
      description: Update an existing reward
      operationId: updateReward
      parameters:
        - name: id
          in: path
          required: true
          description: Reward ID
          schema:
            type: integer
            format: int64
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RewardInput'
      responses:
        '200':
          description: Reward updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Reward'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Reward not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      tags:
        - Rewards
      summary: Delete reward
      description: Delete a reward
      operationId: deleteReward
      parameters:
        - name: id
          in: path
          required: true
          description: Reward ID
          schema:
            type: integer
            format: int64
      responses:
        '204':
          description: Reward deleted successfully
        '404':
          description: Reward not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/members/{memberId}/points:
    get:
      tags:
        - Rewards
      summary: Get member's points balance
      description: Get the current points balance for a family member
      operationId: getMemberPoints
      parameters:
        - name: memberId
          in: path
          required: true
          description: Family member ID
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: Member's points balance
          content:
            application/json:
              schema:
                type: object
                properties:
                  memberId:
                    type: integer
                    format: int64
                  points:
                    type: integer
                  displayName:
                    type: string
        '404':
          description: Member not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/members/{memberId}/rewards/{rewardId}/redeem:
    post:
      tags:
        - Rewards
      summary: Redeem a reward
      description: Redeem a reward for a family member using their points
      operationId: redeemReward
      parameters:
        - name: memberId
          in: path
          required: true
          description: Family member ID
          schema:
            type: integer
            format: int64
        - name: rewardId
          in: path
          required: true
          description: Reward ID
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: Reward redeemed successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RedemptionHistory'
        '400':
          description: Insufficient points or reward not available
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Member or reward not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/members/{memberId}/rewards/history:
    get:
      tags:
        - Rewards
      summary: Get redemption history
      description: Get the reward redemption history for a family member
      operationId: getRedemptionHistory
      parameters:
        - name: memberId
          in: path
          required: true
          description: Family member ID
          schema:
            type: integer
            format: int64
        - name: page
          in: query
          description: Page number for pagination
          schema:
            type: integer
            default: 0
        - name: size
          in: query
          description: Number of items per page
          schema:
            type: integer
            default: 20
      responses:
        '200':
          description: Redemption history
          content:
            application/json:
              schema:
                type: object
                properties:
                  content:
                    type: array
                    items:
                      $ref: '#/components/schemas/RedemptionHistory'
                  pagination:
                    $ref: '#/components/schemas/PaginationMetadata'
        '404':
          description: Member not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # ============================================================================
  # MEALS ENDPOINTS
  # ============================================================================
  /api/meals:
    get:
      tags:
        - Meals
      summary: List meals
      description: Get all meals with optional filtering by date and meal type
      operationId: getMeals
      parameters:
        - name: startDate
          in: query
          description: Filter meals from this date (ISO 8601)
          schema:
            type: string
            format: date
          example: "2024-06-01"
        - name: endDate
          in: query
          description: Filter meals up to this date (ISO 8601)
          schema:
            type: string
            format: date
          example: "2024-06-30"
        - name: category
          in: query
          description: Filter by meal type
          schema:
            type: string
            enum: [breakfast, lunch, dinner, snack]
        - name: page
          in: query
          description: Page number for pagination
          schema:
            type: integer
            default: 0
        - name: size
          in: query
          description: Number of items per page
          schema:
            type: integer
            default: 20
      responses:
        '200':
          description: List of meals
          content:
            application/json:
              schema:
                type: object
                properties:
                  content:
                    type: array
                    items:
                      $ref: '#/components/schemas/Meal'
                  pagination:
                    $ref: '#/components/schemas/PaginationMetadata'

    post:
      tags:
        - Meals
      summary: Create new meal
      description: Create a new meal plan entry
      operationId: createMeal
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MealInput'
            example:
              name: Spaghetti Bolognese
              category: dinner
              assignedDate: "2024-06-15"
              recipe: Cook pasta and prepare meat sauce
              ingredients: ["pasta", "ground beef", "tomato sauce", "onions"]
      responses:
        '201':
          description: Meal created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Meal'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/meals/{id}:
    get:
      tags:
        - Meals
      summary: Get meal details
      description: Get details of a specific meal by ID
      operationId: getMealById
      parameters:
        - name: id
          in: path
          required: true
          description: Meal ID
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: Meal details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Meal'
        '404':
          description: Meal not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    put:
      tags:
        - Meals
      summary: Update meal
      description: Update an existing meal
      operationId: updateMeal
      parameters:
        - name: id
          in: path
          required: true
          description: Meal ID
          schema:
            type: integer
            format: int64
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MealInput'
      responses:
        '200':
          description: Meal updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Meal'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Meal not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      tags:
        - Meals
      summary: Delete meal
      description: Delete a meal
      operationId: deleteMeal
      parameters:
        - name: id
          in: path
          required: true
          description: Meal ID
          schema:
            type: integer
            format: int64
      responses:
        '204':
          description: Meal deleted successfully
        '404':
          description: Meal not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/recipes:
    get:
      tags:
        - Meals
      summary: List recipes
      description: Get all saved recipes
      operationId: getRecipes
      parameters:
        - name: search
          in: query
          description: Search recipes by name or ingredients
          schema:
            type: string
        - name: page
          in: query
          description: Page number for pagination
          schema:
            type: integer
            default: 0
        - name: size
          in: query
          description: Number of items per page
          schema:
            type: integer
            default: 20
      responses:
        '200':
          description: List of recipes
          content:
            application/json:
              schema:
                type: object
                properties:
                  content:
                    type: array
                    items:
                      $ref: '#/components/schemas/Recipe'
                  pagination:
                    $ref: '#/components/schemas/PaginationMetadata'

    post:
      tags:
        - Meals
      summary: Create new recipe
      description: Create a new recipe
      operationId: createRecipe
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RecipeInput'
            example:
              name: Homemade Pizza
              ingredients: ["flour", "yeast", "water", "tomato sauce", "cheese"]
              instructions: Mix flour and yeast, let rise, add toppings, bake
              servings: 4
              prepTime: 30
      responses:
        '201':
          description: Recipe created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Recipe'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/meals/shopping-list:
    get:
      tags:
        - Meals
      summary: Generate shopping list
      description: Generate a shopping list from the meal plan for a date range
      operationId: generateShoppingList
      parameters:
        - name: startDate
          in: query
          required: true
          description: Start date for meal plan (ISO 8601)
          schema:
            type: string
            format: date
          example: "2024-06-01"
        - name: endDate
          in: query
          required: true
          description: End date for meal plan (ISO 8601)
          schema:
            type: string
            format: date
          example: "2024-06-07"
      responses:
        '200':
          description: Generated shopping list
          content:
            application/json:
              schema:
                type: object
                properties:
                  items:
                    type: array
                    items:
                      type: object
                      properties:
                        ingredient:
                          type: string
                        quantity:
                          type: string
                        meals:
                          type: array
                          items:
                            type: string
        '400':
          description: Invalid date range
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # ============================================================================
  # PHOTOS ENDPOINTS
  # ============================================================================
  /api/photos:
    get:
      tags:
        - Photos
      summary: List photos
      description: Get all photos with pagination and filtering
      operationId: getPhotos
      parameters:
        - name: eventId
          in: query
          description: Filter photos by event ID
          schema:
            type: integer
            format: int64
        - name: uploadedBy
          in: query
          description: Filter photos by uploader ID
          schema:
            type: integer
            format: int64
        - name: startDate
          in: query
          description: Filter photos from this date (ISO 8601)
          schema:
            type: string
            format: date-time
        - name: endDate
          in: query
          description: Filter photos up to this date (ISO 8601)
          schema:
            type: string
            format: date-time
        - name: tags
          in: query
          description: Filter by tags (comma-separated)
          schema:
            type: string
        - name: page
          in: query
          description: Page number for pagination
          schema:
            type: integer
            default: 0
        - name: size
          in: query
          description: Number of items per page
          schema:
            type: integer
            default: 20
      responses:
        '200':
          description: List of photos
          content:
            application/json:
              schema:
                type: object
                properties:
                  content:
                    type: array
                    items:
                      $ref: '#/components/schemas/Photo'
                  pagination:
                    $ref: '#/components/schemas/PaginationMetadata'

    post:
      tags:
        - Photos
      summary: Upload new photo
      description: Upload a new photo
      operationId: uploadPhoto
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - file
              properties:
                file:
                  type: string
                  format: binary
                caption:
                  type: string
                eventId:
                  type: integer
                  format: int64
                photoDate:
                  type: string
                  format: date-time
                tags:
                  type: string
                  description: Comma-separated tags
      responses:
        '201':
          description: Photo uploaded successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Photo'
        '400':
          description: Invalid input or file
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/photos/{id}:
    get:
      tags:
        - Photos
      summary: Get photo details
      description: Get details of a specific photo by ID
      operationId: getPhotoById
      parameters:
        - name: id
          in: path
          required: true
          description: Photo ID
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: Photo details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Photo'
        '404':
          description: Photo not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    put:
      tags:
        - Photos
      summary: Update photo metadata
      description: Update photo caption, tags, or other metadata
      operationId: updatePhoto
      parameters:
        - name: id
          in: path
          required: true
          description: Photo ID
          schema:
            type: integer
            format: int64
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PhotoUpdate'
      responses:
        '200':
          description: Photo updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Photo'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Photo not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      tags:
        - Photos
      summary: Delete photo
      description: Delete a photo
      operationId: deletePhoto
      parameters:
        - name: id
          in: path
          required: true
          description: Photo ID
          schema:
            type: integer
            format: int64
      responses:
        '204':
          description: Photo deleted successfully
        '404':
          description: Photo not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/photos/{id}/comments:
    post:
      tags:
        - Photos
      summary: Add comment to photo
      description: Add a comment to a photo
      operationId: addPhotoComment
      parameters:
        - name: id
          in: path
          required: true
          description: Photo ID
          schema:
            type: integer
            format: int64
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - text
              properties:
                text:
                  type: string
                  minLength: 1
                  maxLength: 500
            example:
              text: Great photo! Love the memories.
      responses:
        '201':
          description: Comment added successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PhotoComment'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Photo not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # ============================================================================
  # LISTS ENDPOINTS
  # ============================================================================
  /api/lists:
    get:
      tags:
        - Lists
      summary: List all lists
      description: Get all family lists
      operationId: getLists
      parameters:
        - name: type
          in: query
          description: Filter lists by type
          schema:
            type: string
            enum: [shopping, todo, packing, wish, custom]
        - name: archived
          in: query
          description: Include archived lists
          schema:
            type: boolean
            default: false
        - name: page
          in: query
          description: Page number for pagination
          schema:
            type: integer
            default: 0
        - name: size
          in: query
          description: Number of items per page
          schema:
            type: integer
            default: 20
      responses:
        '200':
          description: List of lists
          content:
            application/json:
              schema:
                type: object
                properties:
                  content:
                    type: array
                    items:
                      $ref: '#/components/schemas/FamilyList'
                  pagination:
                    $ref: '#/components/schemas/PaginationMetadata'

    post:
      tags:
        - Lists
      summary: Create new list
      description: Create a new family list
      operationId: createList
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FamilyListInput'
            example:
              name: Weekly Groceries
              type: shopping
              description: Grocery shopping list for the week
              isShared: true
      responses:
        '201':
          description: List created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FamilyList'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/lists/{id}:
    get:
      tags:
        - Lists
      summary: Get list details with items
      description: Get details of a specific list including all items
      operationId: getListById
      parameters:
        - name: id
          in: path
          required: true
          description: List ID
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: List details with items
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FamilyListWithItems'
        '404':
          description: List not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    put:
      tags:
        - Lists
      summary: Update list
      description: Update an existing list
      operationId: updateList
      parameters:
        - name: id
          in: path
          required: true
          description: List ID
          schema:
            type: integer
            format: int64
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FamilyListInput'
      responses:
        '200':
          description: List updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FamilyList'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: List not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      tags:
        - Lists
      summary: Delete list
      description: Delete a list
      operationId: deleteList
      parameters:
        - name: id
          in: path
          required: true
          description: List ID
          schema:
            type: integer
            format: int64
      responses:
        '204':
          description: List deleted successfully
        '404':
          description: List not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/lists/{id}/items:
    post:
      tags:
        - Lists
      summary: Add item to list
      description: Add a new item to a list
      operationId: addListItem
      parameters:
        - name: id
          in: path
          required: true
          description: List ID
          schema:
            type: integer
            format: int64
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ListItemInput'
            example:
              text: Milk
              priority: medium
      responses:
        '201':
          description: Item added successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListItem'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: List not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/lists/{id}/items/{itemId}:
    patch:
      tags:
        - Lists
      summary: Update list item
      description: Update a list item (check/uncheck or change text)
      operationId: updateListItem
      parameters:
        - name: id
          in: path
          required: true
          description: List ID
          schema:
            type: integer
            format: int64
        - name: itemId
          in: path
          required: true
          description: Item ID
          schema:
            type: integer
            format: int64
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                text:
                  type: string
                checked:
                  type: boolean
                priority:
                  type: string
                  enum: [low, medium, high]
            example:
              checked: true
      responses:
        '200':
          description: Item updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ListItem'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: List or item not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      tags:
        - Lists
      summary: Delete list item
      description: Delete an item from a list
      operationId: deleteListItem
      parameters:
        - name: id
          in: path
          required: true
          description: List ID
          schema:
            type: integer
            format: int64
        - name: itemId
          in: path
          required: true
          description: Item ID
          schema:
            type: integer
            format: int64
      responses:
        '204':
          description: Item deleted successfully
        '404':
          description: List or item not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # ============================================================================
  # FAMILY MEMBERS ENDPOINTS
  # ============================================================================
  /api/members:
    get:
      tags:
        - Members
      summary: List all family members
      description: Get all family members
      operationId: getMembers
      responses:
        '200':
          description: List of family members
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/FamilyMember'

    post:
      tags:
        - Members
      summary: Create new family member
      description: Create a new family member profile
      operationId: createMember
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FamilyMemberInput'
            example:
              username: sarah_doe
              email: sarah@example.com
              password: Sarah$Strong2024Pwd!
              displayName: Sarah
              color: "#FF69B4"
              age: 10
              isParent: false
      responses:
        '201':
          description: Member created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FamilyMember'
        '400':
          description: Invalid input or username/email already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/members/{id}:
    get:
      tags:
        - Members
      summary: Get member details
      description: Get details of a specific family member by ID
      operationId: getMemberById
      parameters:
        - name: id
          in: path
          required: true
          description: Member ID
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: Member details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FamilyMember'
        '404':
          description: Member not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    put:
      tags:
        - Members
      summary: Update member details
      description: Update an existing family member
      operationId: updateMember
      parameters:
        - name: id
          in: path
          required: true
          description: Member ID
          schema:
            type: integer
            format: int64
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/FamilyMemberUpdate'
      responses:
        '200':
          description: Member updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FamilyMember'
        '400':
          description: Invalid input
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Member not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    delete:
      tags:
        - Members
      summary: Delete member
      description: Delete a family member
      operationId: deleteMember
      parameters:
        - name: id
          in: path
          required: true
          description: Member ID
          schema:
            type: integer
            format: int64
      responses:
        '204':
          description: Member deleted successfully
        '404':
          description: Member not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

# ==============================================================================
# COMPONENT SCHEMAS
# ==============================================================================
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  schemas:
    # =========================================================================
    # Authentication Schemas
    # =========================================================================
    RegisterRequest:
      type: object
      required:
        - username
        - email
        - password
      properties:
        username:
          type: string
          minLength: 3
          maxLength: 50
        email:
          type: string
          format: email
        password:
          type: string
          minLength: 8
          maxLength: 100
          description: User password. Must be at least 8 characters. Example shows strong password pattern - real passwords should be unique and not based on common patterns.
        displayName:
          type: string
          maxLength: 100

    LoginRequest:
      type: object
      required:
        - username
        - password
      properties:
        username:
          type: string
        password:
          type: string

    AuthResponse:
      type: object
      properties:
        token:
          type: string
        user:
          $ref: '#/components/schemas/FamilyMember'

    # =========================================================================
    # Event Schemas
    # =========================================================================
    Event:
      type: object
      properties:
        id:
          type: integer
          format: int64
        title:
          type: string
        description:
          type: string
        startDate:
          type: string
          format: date-time
        endDate:
          type: string
          format: date-time
        userId:
          type: integer
          format: int64
        category:
          type: string
        color:
          type: string
          pattern: '^#[0-9A-Fa-f]{6}$'
        isAllDay:
          type: boolean
        recurrencePattern:
          type: string
          description: JSON string with recurrence details
        assignedMembers:
          type: array
          items:
            type: integer
            format: int64
        reminderMinutes:
          type: array
          items:
            type: integer
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    EventInput:
      type: object
      required:
        - title
        - startDate
        - endDate
      properties:
        title:
          type: string
          minLength: 1
          maxLength: 255
        description:
          type: string
          maxLength: 1000
        startDate:
          type: string
          format: date-time
        endDate:
          type: string
          format: date-time
        category:
          type: string
        color:
          type: string
          pattern: '^#[0-9A-Fa-f]{6}$'
        isAllDay:
          type: boolean
          default: false
        recurrencePattern:
          type: string
        assignedMembers:
          type: array
          items:
            type: integer
            format: int64
        reminderMinutes:
          type: array
          items:
            type: integer

    # =========================================================================
    # Task Schemas
    # =========================================================================
    Task:
      type: object
      properties:
        id:
          type: integer
          format: int64
        title:
          type: string
        description:
          type: string
        dueDate:
          type: string
          format: date-time
        assignedUserId:
          type: integer
          format: int64
        priority:
          type: string
          enum: [low, medium, high]
        status:
          type: string
          enum: [pending, in_progress, completed]
        category:
          type: string
        recurrencePattern:
          type: string
        rewardPoints:
          type: integer
        subtasks:
          type: array
          items:
            type: object
            properties:
              text:
                type: string
              completed:
                type: boolean
        orderIndex:
          type: integer
        completedAt:
          type: string
          format: date-time
        createdBy:
          type: integer
          format: int64
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    TaskInput:
      type: object
      required:
        - title
        - createdBy
      properties:
        title:
          type: string
          minLength: 1
          maxLength: 255
        description:
          type: string
          maxLength: 2000
        dueDate:
          type: string
          format: date-time
        assignedUserId:
          type: integer
          format: int64
        priority:
          type: string
          enum: [low, medium, high]
          default: medium
        category:
          type: string
        recurrencePattern:
          type: string
        rewardPoints:
          type: integer
          minimum: 0
          default: 0
        subtasks:
          type: array
          items:
            type: object
            properties:
              text:
                type: string
              completed:
                type: boolean
        createdBy:
          type: integer
          format: int64

    # =========================================================================
    # Reward Schemas
    # =========================================================================
    Reward:
      type: object
      properties:
        id:
          type: integer
          format: int64
        name:
          type: string
        description:
          type: string
        pointsCost:
          type: integer
        category:
          type: string
        imageUrl:
          type: string
          format: uri
        isActive:
          type: boolean
        stockQuantity:
          type: integer
          description: -1 for unlimited, 0+ for limited stock
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    RewardInput:
      type: object
      required:
        - name
        - pointsCost
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 255
        description:
          type: string
          maxLength: 1000
        pointsCost:
          type: integer
          minimum: 0
        category:
          type: string
        imageUrl:
          type: string
          format: uri
        stockQuantity:
          type: integer
          default: -1

    RedemptionHistory:
      type: object
      properties:
        id:
          type: integer
          format: int64
        memberId:
          type: integer
          format: int64
        rewardId:
          type: integer
          format: int64
        rewardName:
          type: string
        pointsSpent:
          type: integer
        redeemedAt:
          type: string
          format: date-time

    # =========================================================================
    # Meal Schemas
    # =========================================================================
    Meal:
      type: object
      properties:
        id:
          type: integer
          format: int64
        name:
          type: string
        category:
          type: string
          enum: [breakfast, lunch, dinner, snack]
        recipe:
          type: string
        ingredients:
          type: array
          items:
            type: string
        assignedDate:
          type: string
          format: date
        dietaryTags:
          type: array
          items:
            type: string
        imageUrl:
          type: string
          format: uri
        isFavorite:
          type: boolean
        createdBy:
          type: integer
          format: int64
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    MealInput:
      type: object
      required:
        - name
        - category
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 255
        category:
          type: string
          enum: [breakfast, lunch, dinner, snack]
        recipe:
          type: string
          maxLength: 5000
        ingredients:
          type: array
          items:
            type: string
        assignedDate:
          type: string
          format: date
        dietaryTags:
          type: array
          items:
            type: string
        imageUrl:
          type: string
          format: uri
        isFavorite:
          type: boolean
          default: false

    Recipe:
      type: object
      properties:
        id:
          type: integer
          format: int64
        name:
          type: string
        ingredients:
          type: array
          items:
            type: string
        instructions:
          type: string
        servings:
          type: integer
        prepTime:
          type: integer
          description: Preparation time in minutes
        imageUrl:
          type: string
          format: uri
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    RecipeInput:
      type: object
      required:
        - name
        - ingredients
        - instructions
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 255
        ingredients:
          type: array
          items:
            type: string
        instructions:
          type: string
          maxLength: 5000
        servings:
          type: integer
          minimum: 1
        prepTime:
          type: integer
          minimum: 0
        imageUrl:
          type: string
          format: uri

    # =========================================================================
    # Photo Schemas
    # =========================================================================
    Photo:
      type: object
      properties:
        id:
          type: integer
          format: int64
        fileName:
          type: string
        filePath:
          type: string
        caption:
          type: string
        comments:
          type: array
          items:
            $ref: '#/components/schemas/PhotoComment'
        eventId:
          type: integer
          format: int64
        photoDate:
          type: string
          format: date-time
        uploadedBy:
          type: integer
          format: int64
        tags:
          type: array
          items:
            type: string
        uploadedAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    PhotoUpdate:
      type: object
      properties:
        caption:
          type: string
          maxLength: 500
        eventId:
          type: integer
          format: int64
        photoDate:
          type: string
          format: date-time
        tags:
          type: array
          items:
            type: string

    PhotoComment:
      type: object
      properties:
        id:
          type: integer
          format: int64
        userId:
          type: integer
          format: int64
        userName:
          type: string
        text:
          type: string
        createdAt:
          type: string
          format: date-time

    # =========================================================================
    # List Schemas
    # =========================================================================
    FamilyList:
      type: object
      properties:
        id:
          type: integer
          format: int64
        name:
          type: string
        type:
          type: string
          enum: [shopping, todo, packing, wish, custom]
        description:
          type: string
        isShared:
          type: boolean
        createdBy:
          type: integer
          format: int64
        isArchived:
          type: boolean
        archivedAt:
          type: string
          format: date-time
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    FamilyListWithItems:
      allOf:
        - $ref: '#/components/schemas/FamilyList'
        - type: object
          properties:
            items:
              type: array
              items:
                $ref: '#/components/schemas/ListItem'

    FamilyListInput:
      type: object
      required:
        - name
        - type
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 255
        type:
          type: string
          enum: [shopping, todo, packing, wish, custom]
        description:
          type: string
          maxLength: 1000
        isShared:
          type: boolean
          default: true

    ListItem:
      type: object
      properties:
        id:
          type: integer
          format: int64
        listId:
          type: integer
          format: int64
        text:
          type: string
        checked:
          type: boolean
        priority:
          type: string
          enum: [low, medium, high]
        addedAt:
          type: string
          format: date-time

    ListItemInput:
      type: object
      required:
        - text
      properties:
        text:
          type: string
          minLength: 1
          maxLength: 255
        priority:
          type: string
          enum: [low, medium, high]
          default: medium

    # =========================================================================
    # Family Member Schemas
    # =========================================================================
    FamilyMember:
      type: object
      properties:
        id:
          type: integer
          format: int64
        username:
          type: string
        email:
          type: string
          format: email
        displayName:
          type: string
        color:
          type: string
          pattern: '^#[0-9A-Fa-f]{6}$'
        age:
          type: integer
        isParent:
          type: boolean
        rewardPoints:
          type: integer
        roles:
          type: string
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    FamilyMemberInput:
      type: object
      required:
        - username
        - email
        - password
        - displayName
      properties:
        username:
          type: string
          minLength: 3
          maxLength: 50
        email:
          type: string
          format: email
        password:
          type: string
          minLength: 8
          maxLength: 100
        displayName:
          type: string
          minLength: 1
          maxLength: 100
        color:
          type: string
          pattern: '^#[0-9A-Fa-f]{6}$'
        age:
          type: integer
          minimum: 0
          maximum: 150
        isParent:
          type: boolean
          default: false

    FamilyMemberUpdate:
      type: object
      properties:
        displayName:
          type: string
          minLength: 1
          maxLength: 100
        email:
          type: string
          format: email
        color:
          type: string
          pattern: '^#[0-9A-Fa-f]{6}$'
        age:
          type: integer
          minimum: 0
          maximum: 150

    # =========================================================================
    # Common Schemas
    # =========================================================================
    ErrorResponse:
      type: object
      properties:
        timestamp:
          type: string
          format: date-time
        status:
          type: integer
        error:
          type: string
        message:
          type: string
        path:
          type: string

    PaginationMetadata:
      type: object
      properties:
        page:
          type: integer
          description: Current page number (0-indexed)
        size:
          type: integer
          description: Number of items per page
        totalElements:
          type: integer
          format: int64
          description: Total number of items
        totalPages:
          type: integer
          description: Total number of pages
        first:
          type: boolean
          description: Whether this is the first page
        last:
          type: boolean
          description: Whether this is the last page
